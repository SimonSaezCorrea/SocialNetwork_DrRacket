#lang racket

(require "date.rkt")

(provide getNombre_C)
(provide getContrasena_C)
(provide getFecha_C)
(provide getActividad_C)
(provide getFollow_C)
(provide getID_C)

(provide account)
(provide account?)
(provide setActividad)
(provide setFollow)

#|
Cuenta -> nombre | contrasena | fecha creacion | actividad | follows | list_follows | ID
          String | String | Date | Boolean | Integer | list account | Integer
|#

;Constructor
(define (account nombre contrasena fecha actividad follow listFollow ID)
  (if (and (string? nombre)
           (string? contrasena)
           (day? fecha)
           (boolean? actividad)
           (integer? follow)
           (integer? ID))
      (list nombre contrasena fecha actividad follow listFollow ID)
      null))

;Selector

(define (getNombre_C cuenta)
  (car cuenta))

(define (getContrasena_C cuenta)
  (car (cdr cuenta)))

(define (getFecha_C cuenta)
  (car (cdr (cdr cuenta))))

(define (getActividad_C cuenta)
  (car (cdr (cdr (cdr cuenta)))))

(define (getFollow_C cuenta)
  (car (cdr (cdr (cdr (cdr cuenta))))))

(define (getListFollow_C cuenta)
  (car (cdr (cdr (cdr (cdr (cdr cuenta)))))))

(define (getID_C cuenta)
  (car (cdr (cdr (cdr (cdr (cdr (cdr cuenta))))))))


;Pertenencia

(define (account? cuenta)
  (if (string? (getNombre_C cuenta))
      (if (string? (getContrasena_C cuenta))
          (if (day? (getFecha_C cuenta))
              (if (boolean? (getActividad_C cuenta))
                  (if (integer? (getFollow_C cuenta))
                      (if (integer? (getID_C cuenta))
                          #t
                          #f)
                      #f)
                  #f)
              #f)
          #f)
      #f))


;Modificadores

(define (setActividad cuenta actividad)
  (if (account? cuenta)
      (if (boolean? actividad)
          (account (getNombre_C cuenta) (getContrasena_C cuenta) (getFecha_C cuenta) actividad (getFollow_C cuenta) (getID_C cuenta))
          cuenta)
      cuenta))

(define (addListFollow cuenta añadirCuenta)
  (if (and (account? cuenta)
           (account? añadirCuenta))
      (account (getNombre_C cuenta) (getContrasena_C cuenta) (getFecha_C cuenta) (getActividad_C cuenta) (+(getFollow_C cuenta) 1) (addListFollow_encaps (getListFollow_C cuenta añadirCuenta)) (getID_C cuenta))
      cuenta))

(define (addListFollow_encaps listCuenta añadirCuenta)
  (if (not(null? listCuenta))
      (cons (car listCuenta) (addListFollow_encaps (cdr listCuenta) añadirCuenta))
      (cons (car listCuenta) null)))